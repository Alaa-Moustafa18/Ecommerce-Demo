<div class="container-fluid mt-1">
  <div class="jumbotron mb-3 p-2">
    <div class="border border-dark mb-2">
      <div class="row justify-content-center mb-3">
        <h2 style="font-family: 'Anton', sans-serif">
          Search for a product &nbsp; <span class="fa fa-search"></span>
        </h2>
      </div>
      <div class="row justify-content-center">
        <div class="d-flex justify-content-center">
          <mat-form-field style="width: 500px">
            <input type="text" aria-label="Name" [matAutocomplete]="autoName"
                   matInput
                   placeholder="Search for a product"
                   name="searchTerm" [(ngModel)]="searchTerm">
          </mat-form-field>
          <mat-autocomplete #autoName="matAutocomplete">
            <mat-option *ngFor="let product of products | productFilter: searchTerm"
                        [value]="product.name">
              {{product.name}}
            </mat-option>
          </mat-autocomplete>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="row mt-3" *ngIf="products && products.length >=1">
  <div class="col-md-4" *ngFor="let product of products | productFilter: searchTerm">
    <div class="card mb-3">
      <img [src]="product.image" *ngIf="product.image" alt="">
      <div class="card-body">
        <h5 class="card-title">{{product.name}}</h5>
        <mat-divider class="m-2"></mat-divider>
        <p class="card-text lead">${{product.price}}</p>
      </div>
      <div class="card-footer">
        <div class="row justify-content-center">
          <button (click)="viewProductDetails(product)" class="btn btn-outline-info">
            View details
          </button>
          <button (click)="openDialog(addToCartDialog)" class="btn btn-outline-primary ml-2"
                  *ngIf="authService.isLoggedIn() && !product.addedToCart">
            Add to cart
          </button>
          <ng-template #addToCartDialog>
            <h2 mat-dialog-title>
              Type here how many quantity you want to add into your cart
            </h2>
            <mat-dialog-content class="mat-typography" style="width: 400px; height: auto;">
              <div class="row justify-content-center mt-2">
                <mat-form-field class="mt-3" appearance="fill">
                  <mat-label>Quantity</mat-label>
                  <input type="number" name="cartQuantity" matInput [(ngModel)]="product.cartQuantity"
                         required placeholder="EX. 10" min="1" max="100">
                </mat-form-field>
              </div>
            </mat-dialog-content>
            <mat-dialog-actions align="end">
              <button type="button" class="btn btn-outline-success pull-right"
                      (click)="pushToCart(product.id, product.cartQuantity)
        ; openSnackBar('product was added successfully into your cart', 'OK');">Add to cart
              </button>
              <button type="button" style="width: 120px;" (click)="hideDialog();"
                      class="btn btn-outline-dark pull-right">
                Close
              </button>
            </mat-dialog-actions>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</div>
